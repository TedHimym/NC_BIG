clc; clear;
VFile = {
    NProData('C:/Users/mfpcz/Documents/ProData/NC_BIGMD/Ra1E6Pr10/R0.010/data/', 'R0p01500-');
    NProData('C:/Users/mfpcz/Documents/ProData/NC_BIGMD/Ra1E6Pr10/R0.020/data/', 'R0p01500-');
    NProData('C:/Users/mfpcz/Documents/ProData/NC_BIGMD/Ra1E6Pr10/R0.040/data/', 'R0p01500-');
    NProData('C:/Users/mfpcz/Documents/ProData/NC_BIGMD/Ra1E6Pr10/R0.080/data/', 'R0p01500-');
    NProData('C:/Users/mfpcz/Documents/ProData/NC_BIGMD/Ra1E6Pr10/R0.250/data/', 'R0p01500-');
    NProData('C:/Users/mfpcz/Documents/ProData/NC_BIGMD/Ra1E6Pr10/R0.400/data/', 'R0p01500-');

    NProData('./Ra1E7Pr10/R0.010/data/', 'R0p10000-');
    NProData('./Ra1E7Pr10/R0.020/data/', 'R0p10000-');
    NProData('./Ra1E7Pr10/R0.040/data/', 'R0p10000-');
    NProData('./Ra1E7Pr10/R0.080/data/', 'R0p10000-');
    NProData('./Ra1E7Pr10/R0.250/data/', 'R0p10000-');
    NProData('./Ra1E7Pr10/R0.400/data/', 'R0p10000-');
    
    NProData('./Ra1E8Pr10/R0.010/data/', 'R0p01000-');
    NProData('./Ra1E8Pr10/R0.020/data/', 'R0p01000-');
    NProData('./Ra1E8Pr10/R0.040/data/', 'R0p01000-');
    NProData('./Ra1E8Pr10/R0.080/data/', 'R0p01000-');
    NProData('./Ra1E8Pr10/R0.250/data/', 'R0p01000-');
    NProData('./Ra1E8Pr10/R0.400/data/', 'R0p01000-');
    
    NProData('./Ra5E8Pr10/R0.010/data/', 'R0p01000-');
    NProData('./Ra5E8Pr10/R0.020/data/', 'R0p01000-');
    NProData('./Ra5E8Pr10/R0.040/data/', 'R0p01000-');
    NProData('./Ra5E8Pr10/R0.080/data/', 'R0p01000-');
    NProData('./Ra5E8Pr10/R0.250/data/', 'R0p01000-');
    NProData('./Ra5E8Pr10/R0.400/data/', 'R0p01000-');
    
};

h = 0.5;

[U, UeR] = arrayfun(...
    @(eRa7) ...
    eRa7{1}.getmU(h, eRa7{1}.TotolTime),...
    VFile);
[theta, TeR] = arrayfun(...
    @(eRa7) ...
    eRa7{1}.TBL_TR(h, eRa7{1}.TotolTime),...
    VFile);
[vtheta, vTeR] = arrayfun(...
    @(eRa7) ...
    eRa7{1}.VBL_TR(h, eRa7{1}.TotolTime),...
    VFile); 

sR = [0.01 0.02 0.04 0.08 0.25 0.4];

R = [sR sR sR sR]';

g = [...
    9.8  * ones(size(sR)) ...
    98   * ones(size(sR)) ...
    980  * ones(size(sR)) ...
    4900 * ones(size(sR)) ...
    ]';
k = [...
    0.0001*ones(size(sR)) ...
    0.0001*ones(size(sR)) ...
    0.0001*ones(size(sR)) ...
    0.0001*ones(size(sR)) ...
    ]';
Ra = [...
    1e6*ones(size(sR)) ...
    1e7*ones(size(sR)) ...
    1e8*ones(size(sR)) ...
    5e8*ones(size(sR)) ...
    ]';
visco = [...
    0.001*ones(size(sR)) ...
    0.001*ones(size(sR)) ...
    0.001*ones(size(sR)) ...
    0.001*ones(size(sR)) ...
    ]';
alpha = [...
    0.0001*ones(size(sR)) ...
    0.0001*ones(size(sR)) ...
    0.0001*ones(size(sR)) ...
    0.0001*ones(size(sR)) ...
    ]';